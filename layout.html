<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>lunchï¼†dinner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>
  <body>
    <header>
      <div class="brand">
        {% if user %}
          {% if user.avatar %}
            <img class="avatar-img" src="{{ url_for('static', filename='uploads/avatars/' ~ user.avatar) }}" alt="avatar">
          {% else %}
            <span class="avatar">{{ user.username[:1]|upper }}</span>
          {% endif %}
        {% endif %}
        <h1><a href="/">lunchï¼†dinner</a></h1>
      </div>
      <nav>
        {% if user %}
          <span>ã‚ˆã†ã“ãã€<a href="/user/{{ user.username }}">{{ user.username }}</a>ã•ã‚“</span>
          <a href="/logout">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
          <a href="http://lundi.com" target="_blank" rel="noopener" style="margin-left:8px">lundi.com</a>
          <a href="/pricing" style="margin-left:8px">ğŸ’ è³¼èª­</a>
          <button id="themeToggle" class="theme-toggle" type="button" title="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">ãƒ©ã‚¤ãƒˆ</button>
        {% else %}
          <a href="/login">ãƒ­ã‚°ã‚¤ãƒ³</a>
          <a href="/register">ç™»éŒ²</a>
          <a href="http://lundi.com" target="_blank" rel="noopener" style="margin-left:8px">lundi.com</a>
          <a href="/pricing" style="margin-left:8px">ğŸ’ è³¼èª­</a>
          <button id="themeToggle" class="theme-toggle" type="button" title="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">ãƒ©ã‚¤ãƒˆ</button>
        {% endif %}
      </nav>
    </header>
    <main>
      <div class="app-shell">
        <aside class="sidebar">
          <ul class="nav-list">
            <li><a class="{% if request.endpoint=='index' %}active{% endif %}" href="/">ğŸ  TL</a></li>
            <li><a class="{% if request.endpoint=='search' %}active{% endif %}" href="/search">ğŸ” æ¤œç´¢</a></li>
            <li><a class="{% if request.endpoint=='notifications' %}active{% endif %}" href="/notifications">ğŸ”” é€šçŸ¥</a></li>
            <li><a class="{% if request.endpoint=='bookmarks' %}active{% endif %}" href="/bookmarks">ğŸ”– ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</a></li>
          </ul>
        </aside>
        <section class="content">
          {% with messages = get_flashed_messages() %}
            {% if messages %}
              <ul class="flashes">
                {% for m in messages %}
                  <li>{{ m }}</li>
                {% endfor %}
              </ul>
            {% endif %}
          {% endwith %}
          {% block content %}{% endblock %}
        </section>
      </div>
      <nav class="bottom-nav">
        <a class="{% if request.endpoint=='index' %}active{% endif %}" href="/">ğŸ  TL</a>
        <a class="{% if request.endpoint=='search' %}active{% endif %}" href="/search">ğŸ” æ¤œç´¢</a>
        <a class="{% if request.endpoint=='notifications' %}active{% endif %}" href="/notifications">ğŸ”” é€šçŸ¥</a>
        <a class="{% if request.endpoint=='bookmarks' %}active{% endif %}" href="/bookmarks">ğŸ”– ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</a>
      </nav>
    </main>
    <footer>
      <small>lunchï¼†dinner â€” <a href="http://lundi.com" target="_blank" rel="noopener">lundi.com</a></small>
    </footer>
    <script>
    (function(){
      const key='theme';
      const saved=localStorage.getItem(key);
      if(saved){ document.documentElement.setAttribute('data-theme', saved); }
      function updateIcon(){
        const btn=document.getElementById('themeToggle');
        const t=document.documentElement.getAttribute('data-theme')||'light';
        if(btn){ btn.textContent = t==='dark' ? 'ãƒ€ãƒ¼ã‚¯' : 'ãƒ©ã‚¤ãƒˆ'; }
      }
      document.addEventListener('DOMContentLoaded', function(){
        updateIcon();
        const btn=document.getElementById('themeToggle');
        if(btn){ btn.addEventListener('click', function(){
          const cur=document.documentElement.getAttribute('data-theme')||'light';
          const next=cur==='dark' ? 'light' : 'dark';
          document.documentElement.setAttribute('data-theme', next);
          localStorage.setItem(key, next);
          updateIcon();
        }); }
      });
    })();
    </script>
  </body>
</html>
